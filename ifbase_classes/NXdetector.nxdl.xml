<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="nxdlformat.xsl" ?>
<!--
# NeXus - Neutron and X-ray Common Data Format
# 
# Copyright (C) 2008-2013 NeXus International Advisory Committee (NIAC)
# 
# This library is free software; you can redistribute it and/or
# modify it under the terms of the GNU Lesser General Public
# License as published by the Free Software Foundation; either
# version 3 of the License, or (at your option) any later version.
#
# This library is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
# Lesser General Public License for more details.
#
# You should have received a copy of the GNU Lesser General Public
# License along with this library; if not, write to the Free Software
# Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
#
# For further information, see http://www.nexusformat.org

########### SVN repository information ###################
# $Date: 2013-11-21 11:18:19 +0100 (Thu, 21 Nov 2013) $
# $Author: Mark Koennecke $
# $Revision: 1248 $
# $HeadURL: https://svn.nexusformat.org/definitions/branches/interfaces/base_classes/NXdetector.nxdl.xml $
# $Id: NXdetector.nxdl.xml 1248 2013-11-21 10:18:19Z Mark Koennecke $
########### SVN repository information ###################
-->
<definition category="base" extends="NXobject" name="NXdetector"
            svnid="$Id: NXdetector.nxdl.xml 1248 2013-11-21 10:18:19Z Mark Koennecke $"
            type="group" version="1.1"
            xsi:schemaLocation="http://definition.nexusformat.org/nxdl/@NXDL_RELEASE@ ../nxdl.xsd"
            xmlns="http://definition.nexusformat.org/nxdl/@NXDL_RELEASE@"
            xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
            xmlns:xs="http://www.w3.org/2001/XMLSchema"
            xmlns:ns="http://definition.nexusformat.org/nxdl/@NXDL_RELEASE@"
            >
 	<attribute name="implements" type="NX_CHAR">
		<doc>
			NXdetector will of course only implement those interfaces out of the selection 
			below which match the detector used and the mode in which the instrument was 
			operated.
			
			NXdetector can implement: NXIFbeamline_component, NXIFmetadata, NXIFphoton_counter,
			NXIFgasdetector, NXIFcount_time, NXIFcount_time_scanned,
			NXIFsingle_detector, NXIFsingle_detector_scanned, NXIFsingle_detector_tof,
			NXIFlinear_detector, NXIFlinear_detector_scanned, NXIFlinear_detector_tof,
			NXIFarea_detector, NXIFarea_detector_scanned, NXIFarea_detector_tof,
			NXIFgeneric_detector, NXIFgeneric_detector_scanned, NXIFgeneric_detector_tof,
			
		</doc>
	</attribute>
 
  <symbols>
    <doc>These symbols will be used below to coordinate datasets with the same shape.</doc>
    <symbol name="np"><doc>number of scan points (only present in scanning measurements)</doc></symbol>
    <symbol name="i"><doc>number of detector pixels in the first (X, slowest) direction</doc></symbol>
    <symbol name="j"><doc>number of detector pixels in the second (Y, faster) direction</doc></symbol>
    <symbol name="k"><doc>number of detector pixels in the third (Z, if necessary, fastest) direction</doc></symbol>
    <symbol name="tof"><doc>number of bins in the time-of-flight histogram</doc></symbol>
  </symbols>

  <doc>
    Template of a detector, detector bank, or multidetector.
  </doc>


  <field name="detector_number" type="NX_INT">
    <doc>Identifier for detector</doc>

    <dimensions rank="2">
      <dim index="1" value="i" />
      <dim index="2" value="j" />
    </dimensions>
  </field>

  <field name="solid_angle" type="NX_FLOAT" units="NX_SOLID_ANGLE">
    <doc>Solid angle subtended by the detector at the sample</doc>

    <dimensions rank="2">
      <dim index="1" value="i" />
      <dim index="2" value="j" />
    </dimensions>
  </field>


  <field name="crate" type="NX_INT">
    <doc>Crate number of detector</doc>

    <dimensions rank="2">
      <dim index="1" value="i" />
      <dim index="2" value="j" />
    </dimensions>

    <attribute name="local_name">
      <doc>Equivalent local term</doc>
    </attribute>
  </field>

  <field name="slot" type="NX_INT">
    <doc>Slot number of detector</doc>

    <dimensions rank="2">
      <dim index="1" value="i" />
      <dim index="2" value="j" />
    </dimensions>

    <attribute name="local_name">
      <doc>Equivalent local term</doc>
    </attribute>
  </field>

  <field name="input" type="NX_INT">
    <doc>Input number of detector</doc>

    <dimensions rank="2">
      <dim index="1" value="i" />
      <dim index="2" value="j" />
    </dimensions>

    <attribute name="local_name">
      <doc>Equivalent local term</doc>
    </attribute>
  </field>



    <field name="wavelength" type="NX_FLOAT" units="NX_WAVELENGTH">
      <doc>TODO: need documentation</doc>

      <dimensions rank="3">
        <dim index="1" value="i" />
        <dim index="2" value="j" />
        <dim index="3" value="k" />
      </dimensions>
    </field>
    

  <field name="calibration_date" type="NX_DATE_TIME">
    <doc>
    	date of last calibration (geometry and/or efficiency) measurements
    </doc>
  </field>

  <group name="calibration_method" type="NXnote">
    <doc>
	    summary of conversion of array data to pixels (e.g. polynomial
	    approximations) and location of details of the calibrations
    </doc>
  </group>

  <field name="layout">
    <doc>How the detector is represented</doc>

    <enumeration>
      <item value="point"/>
      <item value="linear"/>
      <item value="area"/>
    </enumeration>
  </field>


  <group name="data_file" type="NXnote"/>

  <group type="NXcharacterization"/> <!-- TODO: consider using NXcollection instead, see http://trac.nexusformat.org/definitions/ticket/177-->

  <group name="modulexx" type="NXdetector_module">
	  <doc>
		  In some cases detectors are built up from smaller modules. This group holds information about 
		  the modules a larger detector may be built up from. 
	  </doc>
  </group>


  <field name="diameter" type="NX_FLOAT" units="NX_LENGTH">
    <doc>The diameter of a cylindrical detector</doc>
  </field>

  <field name="acquisition_mode" type="NX_CHAR">
    <doc>The acquisition mode of the detector.</doc>
  <enumeration>
    <item value="gated"/>
    <item value="triggered"/>
    <item value="summed"/>
    <item value="event"/>
    <item value="histogrammed"/>
  </enumeration>
  </field>
</definition>
